<template>
  <TheCard
    :image="article.coverImage"
    :title="article.title"
    :is-video="(article.embedVideo as boolean)"
    :description="article.excerpt"
    :label="(label as string)"
    :link="articleLink"
    :footer="formattedDate"
    :full-screen="fullScreen"
    :countries="article.countries"
  />
</template>

<script lang="ts" setup>
import type { NewsArticle } from '~/types/dato-models/NewsArticle'

const props = defineProps({
  article: {
    type: Object as PropType<NewsArticle>,
    required: true
  },
  fullScreen: {
    type: Boolean,
    default: false
  }
})

const formattedDate = computed(() => {
  const date = new Date(props.article._createdAt)
  const year = date.getFullYear()
  const month = date.getMonth()
  const day = date.getDate()
  return `${day}-${month}-${year}`
})

const articleLink: Ref<string> = computed(() => {
  if (props.article.externalArticleUrl) {
    return props.article.externalArticleUrl
  }
  return `news/${props.article.slug}`
})

const label: ComputedRef<string | null> = computed(() => {
  if (props.article.externalArticleUrl) {
    return null
  } else {
    return `
    <svg class="mr-8 h-18" viewBox="0 0 21 19" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.1123 4.30305C13.1123 4.30305 13.0834 4.30177 13.0544 4.30048C13.0544 4.30048 13.0544 4.30049 13.0255 4.2992L12.6784 4.28384L11.9251 4.27945L7.86917 4.2447L7.87045 4.21579C7.91223 2.62437 9.12964 1.31676 10.7032 1.12571C10.7032 1.12571 10.7321 1.12699 10.761 1.12827C10.7899 1.12955 10.8189 1.13083 10.8189 1.13083L10.8478 1.13212L11.1949 1.14748L11.8627 1.11912L15.9186 1.15386L15.9173 1.18277C15.9032 2.80439 14.6556 4.13963 13.1123 4.30305Z" fill="#FC8702"/>
      <path d="M7.18724 4.91316C7.18724 4.91316 7.18724 4.9421 7.15829 4.9421V5.02892L6.98457 5.26044L6.60818 5.92606L4.55249 9.42781C4.55249 9.42781 4.55249 9.42781 4.52354 9.42781C3.13378 8.61749 2.58366 6.88108 3.22064 5.43408C3.22064 5.43408 3.22064 5.40514 3.24959 5.40514C3.24959 5.3762 3.27854 5.34726 3.27854 5.34726L3.3075 5.31832L3.48122 5.02892L3.82866 4.45012L5.85539 0.919434C5.85539 0.919434 5.85539 0.919434 5.88434 0.919434C7.2741 1.7587 7.82422 3.46616 7.18724 4.91316Z" fill="#E9B213"/>
      <path d="M7.21717 14.8396C5.79846 15.65 4.06126 15.2448 3.1058 14.0004L3.07685 13.9714L3.04789 13.9136L3.01894 13.8846L2.84522 13.5952L2.49778 13.0164L0.5 9.48573C0.5 9.48573 0.5 9.48573 0.528953 9.48573C1.94767 8.67541 3.68487 9.08057 4.64033 10.325L4.66928 10.3539L4.843 10.6433L5.21939 11.309L7.21717 14.8396Z" fill="#21BCA5"/>
      <path d="M10.4023 18.4859C10.4023 18.4859 10.3733 18.4859 10.3444 18.4859C10.3444 18.4859 10.3444 18.4859 10.3154 18.4859H9.968H9.21521H5.16174V18.457C5.16174 16.8363 6.37778 15.5051 7.94126 15.3025C7.94126 15.3025 7.97022 15.3025 7.99917 15.3025C8.02812 15.3025 8.05708 15.3025 8.05708 15.3025H8.08603H8.43347H9.0994H13.1529V15.3314C13.1818 16.9521 11.9947 18.2833 10.4023 18.4859Z" fill="#0582CA"/>
      <path d="M17.9872 14.3185C17.9872 14.3185 17.9872 14.3475 17.9583 14.3475L17.7846 14.6369L17.4082 15.3025L15.3814 18.8043C15.3814 18.8043 15.3814 18.8043 15.3525 18.8043C13.9627 17.9939 13.3836 16.2865 14.0206 14.8395C14.0206 14.8395 14.0206 14.8105 14.0496 14.8105C14.0496 14.7816 14.0785 14.7526 14.0785 14.7526L14.1075 14.7237L14.2812 14.4343L14.6286 13.8555L16.6554 10.3538C16.6554 10.3538 16.6554 10.3538 16.6843 10.3538C18.0451 11.1641 18.5952 12.8715 17.9872 14.3185Z" fill="#1F2348"/>
      <path d="M20.8541 10.0351C19.4644 10.8744 17.6982 10.556 16.7138 9.31162L16.6848 9.28268L16.6559 9.2248L16.6269 9.19586L16.4532 8.90646L16.1058 8.32766L13.9922 4.8838C13.9922 4.8838 13.9922 4.8838 14.0211 4.8838C15.4109 4.04453 17.1771 4.36287 18.1615 5.6073L18.1904 5.63624L18.3641 5.92564L18.7695 6.56232L20.8541 10.0351C20.8831 10.0351 20.8831 10.0351 20.8541 10.0351Z" fill="#D94432"/>
    </svg>
    <span class="leading-[100%]">${props.fullScreen ? 'Featured Article' : 'Cryptocity article'}</span>
    `
  }
})

</script>
